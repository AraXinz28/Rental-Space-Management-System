<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Rectangle?>

<AnchorPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.rental.controller.SpaceController"
            style="-fx-background-color:#f8f9fa;">

    <!-- ✅ DEFINE OBJECT (สำคัญมาก) -->
    <fx:define>
        <ToggleGroup fx:id="zoneGroup"/>
    </fx:define>

    <!-- HEADER -->
    <fx:include source="header.fxml"
                AnchorPane.topAnchor="0"
                AnchorPane.leftAnchor="0"
                AnchorPane.rightAnchor="0"/>

    <!-- BODY -->
    <HBox AnchorPane.topAnchor="80"
          AnchorPane.leftAnchor="0"
          AnchorPane.rightAnchor="0"
          AnchorPane.bottomAnchor="0">

        <fx:include source="sidebarTenant.fxml"/>

        <ScrollPane fitToWidth="true"
                    HBox.hgrow="ALWAYS"
                    vbarPolicy="AS_NEEDED"
                    hbarPolicy="NEVER">

            <content>
                <VBox spacing="20">
                    <padding>
                        <Insets top="20" right="40" bottom="40" left="40"/>
                    </padding>

                    <Label text="ค้นหาพื้นที่"
                           style="-fx-font-size:24; -fx-font-weight:bold;"/>

                    <!-- SEARCH -->
                    <HBox spacing="15">
                        <TextField fx:id="searchField"
                                   promptText="โซน / หมายเลขแผง"
                                   prefWidth="260"/>

                        <ComboBox fx:id="statusCombo"
                                  promptText="ทุกสถานะ"
                                  prefWidth="160"/>

                        <ComboBox fx:id="typeCombo"
                                  promptText="ประเภทสินค้า"
                                  prefWidth="200"/>
                    </HBox>

                    <!-- DATE + BUTTON -->
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <Label text="วันที่ต้องการเช่า"/>
                        <DatePicker fx:id="rentDate"/>
                        <Button text="ล้างตัวกรอง"
                                onAction="#handleClearFilter"/>
                        <Button text="ค้นหา"
                                onAction="#handleSearch"/>
                    </HBox>

                    <Separator/>

                    <Label text="ผังแผนที่"
                           style="-fx-font-size:20; -fx-font-weight:bold;"/>

                    <!-- ZONE BUTTON -->
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <ToggleButton text="โซนA" toggleGroup="$zoneGroup" selected="true"/>
                        <ToggleButton text="โซนB" toggleGroup="$zoneGroup"/>
                        <ToggleButton text="โซนC" toggleGroup="$zoneGroup"/>
                        <ToggleButton text="โซนD" toggleGroup="$zoneGroup"/>
                        <ToggleButton text="โซนE" toggleGroup="$zoneGroup"/>
                        <ToggleButton text="โซนF" toggleGroup="$zoneGroup"/>
                        <ToggleButton text="โซนG" toggleGroup="$zoneGroup"/>

                        <Region HBox.hgrow="ALWAYS"/>

                        <Button text="คลิกที่นี่เพื่อดูผังพื้นที่"
                                onAction="#handleShowMap"
                                style="-fx-background-color:transparent;
                                       -fx-text-fill:#778cab;
                                       -fx-underline:true;"/>
                    </HBox>

                    <!-- LEGEND -->
                    <HBox spacing="25" alignment="CENTER">
                        <HBox spacing="8"><Rectangle width="18" height="18" fill="#2e8b61ff"/><Label text="ว่าง"/></HBox>
                        <HBox spacing="8"><Rectangle width="18" height="18" fill="#982d2dff"/><Label text="ถูกเช่า"/></HBox>
                        <HBox spacing="8"><Rectangle width="18" height="18" fill="#bac04dff"/><Label text="กำลังดำเนินการ"/></HBox>
                        <HBox spacing="8"><Rectangle width="18" height="18" fill="#6c757d"/><Label text="ปิดปรับปรุง"/></HBox>
                    </HBox>

                    <!-- GRID -->
                    <GridPane fx:id="spaceGrid"
                              hgap="20"
                              vgap="20"
                              alignment="CENTER"
                              maxWidth="Infinity">

                        <columnConstraints>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                        </columnConstraints>
                    </GridPane>

                </VBox>
            </content>
        </ScrollPane>
    </HBox>
</AnchorPane>
